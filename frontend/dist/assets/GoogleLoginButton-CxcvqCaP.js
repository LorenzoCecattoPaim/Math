import{r as c,j as o,d as f}from"./index-BHZVmxCX.js";import{B as C}from"./button-YsjuXer5.js";const p="google-identity-service";function G(){return o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"w-5 h-5",children:o.jsx("path",{fill:"#EA4335",d:"M12 10.2v3.9h5.5c-.2 1.2-1.4 3.6-5.5 3.6-3.3 0-6-2.8-6-6.2s2.7-6.2 6-6.2c1.9 0 3.1.8 3.8 1.5l2.6-2.5C16.7 2.7 14.6 2 12 2 6.9 2 2.8 6.3 2.8 11.5S6.9 21 12 21c6.9 0 8.7-4.9 8.7-7.4 0-.5 0-.9-.1-1.3H12z"})})}function j({onSuccess:m,onError:i,disabled:h=!1}){const[s,u]=c.useState(!1),[d,r]=c.useState(!1),e=c.useRef(null),l="394104757108-0qgmntct5pvfti1in4ul37nr24074pph.apps.googleusercontent.com";c.useEffect(()=>{var a,g;const n=document.getElementById(p);if(n){(g=(a=window.google)==null?void 0:a.accounts)!=null&&g.oauth2?u(!0):n.addEventListener("load",()=>u(!0),{once:!0});return}const t=document.createElement("script");t.id=p,t.src="https://accounts.google.com/gsi/client",t.async=!0,t.defer=!0,t.onload=()=>u(!0),t.onerror=()=>i("Nao foi possivel carregar o login do Google."),document.body.appendChild(t)},[l,i]),c.useEffect(()=>()=>{e.current!==null&&window.clearTimeout(e.current)},[]);const w=()=>{var n,t;return!((t=(n=window.google)==null?void 0:n.accounts)!=null&&t.oauth2)||!l?null:window.google.accounts.oauth2.initTokenClient({client_id:l,scope:"openid email profile",callback:async a=>{if(e.current!==null&&(window.clearTimeout(e.current),e.current=null),a.error||!a.access_token){r(!1),i("Falha ao autenticar com Google. Tente novamente.");return}try{await m(a.access_token)}finally{r(!1)}},error_callback:a=>{e.current!==null&&(window.clearTimeout(e.current),e.current=null),r(!1),i(`Falha no popup do Google (${a.type||"erro_desconhecido"}). Verifique bloqueador de popup e tente novamente.`)}})},x=()=>{if(!s)return;const n=w();if(!n){i("Configuracao Google invalida.");return}r(!0),e.current=window.setTimeout(()=>{r(!1),i("Tempo excedido ao receber resposta do Google. Confira origem autorizada no Google Cloud e tente novamente.")},12e4);try{n.requestAccessToken({prompt:"consent"})}catch{e.current!==null&&(window.clearTimeout(e.current),e.current=null),r(!1),i("Nao foi possivel iniciar o popup do Google.")}};return o.jsx(C,{type:"button",variant:"outline",size:"lg",className:"w-full",onClick:x,disabled:h||d||!l||!s,children:d?o.jsxs(o.Fragment,{children:[o.jsx(f,{className:"w-4 h-4 animate-spin"}),"Conectando..."]}):s?o.jsxs(o.Fragment,{children:[o.jsx(G,{}),"Continuar com Google"]}):o.jsxs(o.Fragment,{children:[o.jsx(f,{className:"w-4 h-4 animate-spin"}),"Carregando Google..."]})})}export{j as G};
